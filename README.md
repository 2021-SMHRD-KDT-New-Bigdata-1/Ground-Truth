# Ground-Truth
## ğŸŒ í”„ë¡œì íŠ¸ ê¸°íš ì´ìœ 

ë‹¹ì‹œ í•™ì› ë‹¤ë‹ ë•Œì˜ ë§¡ê²Œëœ ê¸°ì—…í”„ë¡œì íŠ¸ë¡œ, ì˜¤í†  ë¼ë²¨ë§ì´ë¼ëŠ” ì„œë¹„ìŠ¤ë¥¼ ë§¡ê²Œ ë˜ì—ˆë‹¤. 

## ğŸ¤© í”„ë¡œì íŠ¸ ê°œë°œ ëª©í‘œ ë° ë‚´ìš©

- ***íšŒì›ê°€ì…ê³¼ ë¡œê·¸ì¸***
    - íšŒì›ê°€ì…ì„ í•˜ê³  ë¡œê·¸ì¸í•´ì•¼ ì‚¬ìš©ìê°€ ë¼ë²¨ë§í•˜ë ¤ê³  í•˜ëŠ” ë¬¼ì²´ì˜ ì—…ë¡œë“œë“±ì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ì˜€ë‹¤.
- ***ë¼ë²¨ë§***
    - ë™ì˜ìƒì„ ì—…ë¡œë“œí•´ì•¼ í•œë‹¤.
    - ë™ì˜ìƒì„ ì—…ë¡œë“œí•˜ê³  ì´ë¥¼ bboxë¼ê³  í•˜ì—¬ ë¬¼ì²´ê°€ ì–´ë””ìˆëŠ”ì§€ ì‚¬ìš©ìê°€ í‘œì‹œí•´ì¤˜ì•¼ í•œë‹¤.
    - ë™ì˜ìƒì´ í´ ìˆ˜ë¡ í‘œì‹œí•´ì¤˜ì•¼ í•˜ëŠ” ë°•ìŠ¤ ê°¯ìˆ˜ê°€ ëŠ˜ì–´ë‚œë‹¤. ì´ëŠ” ìµœëŒ€ 10ê°œë¡œë§Œ ì œí•œí•˜ì˜€ë‹¤.
- ***ê²°ê³¼ë¬¼***
    - ë¼ë²¨ë§í•œ ê²°ê³¼ë¬¼ì´ xmlë¡œ ë‚˜ì˜¨ë‹¤. ì´ë¥¼ ì—¬ëŸ¬ ë™ì˜ìƒì—ì„œë„ í‘œì‹œí•  ìˆ˜ ìˆê²Œ í•˜ì˜€ë‹¤.

## **1. ì‚¬ìš© ê¸°ìˆ **

- **ì–¸ì–´** : Python, Flask, HTML, CSS, Javascript, SQL
- **DB** : Oracle
- **Framworks** : Bootstrap
- **IDEs** : Vscode

## 2**. í”„ë¡œì íŠ¸ ì¼ì •**

![https://user-images.githubusercontent.com/89984853/198654840-1af0df68-a262-4d93-82a4-ae77b238908f.png](https://user-images.githubusercontent.com/89984853/198654840-1af0df68-a262-4d93-82a4-ae77b238908f.png)

## 3**. êµ¬í˜„ í™”ë©´**

[í”„ë¡œì íŠ¸2ì°¨ ì˜ìƒ.mp4](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1336fdc4-9a6e-4e01-ab67-275c79fc80ff/í”„ë¡œì íŠ¸2ì°¨_ì˜ìƒ.mp4)

### í˜ì´ì§€ ì†Œê°œ

â†’ í”„ë¡œì íŠ¸ì˜ í˜ì´ì§€ëŠ” **ëŒ€í‘œì ìœ¼ë¡œ ì„¸ ê°œë¡œ ì´ë£¨ì–´ì ¸** ìˆë‹¤. êµ¬í˜„ í™”ë©´ì€ pptì‚¬ì§„ìœ¼ë¡œ ëŒ€ì‹ í•œë‹¤. 

### 1) ***ì²«ë²ˆì§¸ í˜ì´ì§€***

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/82072061-7a6d-4fce-9db5-82e538f07a81/Untitled.png)

ê·¸ë¦¬ê³  ì²˜ìŒ ë“¤ì–´ê°„ ì‚¬ìš©ìë“¤ì´ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ í•œ ëˆˆì— ì•Œì•„ë³¼ ìˆ˜ ìˆê²Œë” ì‚¬ìš© ì„¤ëª…ì„œë¥¼ ë„£ì—ˆë‹¤. ì´ì— ëŒ€í•œ ì˜ìƒì´ ë‚˜ì˜¤ê²Œ ë™ì˜ìƒ íŒŒì¼ë„ ë„£ì—ˆë‹¤. ê·¸ë¦¬ê³  ***ë¼ë²¨ë§í•˜ê³ ì í•˜ëŠ” ì˜ìƒì„ ì—…ë¡œë“œ***í•˜ë©´ ì´ì˜ ì´ë¯¸ì§€ë¥¼ í”„ë ˆì„ë§ˆë‹¤ ì €ì¥í•˜ê³  ì²˜ë¦¬ê°€ ì–´ëŠì •ë„ ë˜ì—ˆëŠ”ì§€ í”„ë¡œê·¸ë˜ìŠ¤ ë°”ë¡œ í‘œì‹œí•˜ê²Œ í•˜ì˜€ë‹¤. ì‚¬ìš©ìë¡œ í•˜ì—¬ê¸ˆ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì´ ì§€ë£¨í•˜ì§€ ì•Šë„ë¡ ì‹œê°ì ìœ¼ë¡œ í™•ì¸ë˜ê²Œ í•˜ì˜€ë‹¤.

### 2) ***ë‘ë²ˆì§¸ í˜ì´ì§€***

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7ae541e6-0e30-4fa5-9d3f-7e3f57fa34e1/Untitled.png)

ì˜ìƒì˜ ëŒ€í‘œì ì¸ ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ë‚˜íƒ€ë‚˜ê²Œ í•˜ì˜€ë‹¤. ì•„ë˜ìª½ì—ëŠ” ì´ í”„ë ˆì„ ìˆ˜ì™€ ëŒ€í‘œ í”„ë ˆì„ìˆ˜ë¥¼ ë„£ì—ˆë‹¤. ê·¸ë¦¬ê³  ë‹¤ìŒ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ***ëŒ€í‘œí”„ë ˆì„ì„ ë¶ˆëŸ¬ì™€ì„œ ì‚¬ìš©ì ë³¸ì¸ì´ ë°”ìš´ë“œ ë°•ìŠ¤ë¥¼ ì¹˜ê²Œ*** í•œë‹¤. ì´ ë§ì€ ë™ì˜ìƒì—ì„œ ì–´ë– í•œ ê°ì²´ë¥¼ ì¶”ì í•˜ë ¤ê³  í•˜ëŠ”ì§€ ì‚¬ìš©ìë¡œ í•˜ì—¬ í‘œì‹œí•˜ê²Œ í•˜ì˜€ë‹¤. ê·¸ë¦¬ê³  ê·¸ ì¢Œí‘œê°’ì„ ì €ì¥í•˜ì—¬ ë‹¤ìŒí˜ì´ì§€ë¡œ ë„˜ê²¨ì¤€ë‹¤.

### 3) ***ì„¸ë²ˆì§¸ í˜ì´ì§€***

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f8c5dac4-1eed-4e96-b24f-3a5760980760/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/760d5572-f681-417c-b174-d63d76969009/Untitled.png)

***ì „ì²´ ì´ë¯¸ì§€ì™€ ì¢Œí‘œê°’ë“¤ì— ëŒ€í•œ ì••ì¶• íŒŒì¼ì„ ë‹¤ìš´***ë¡œë“œ ë°›ì„ ìˆ˜ ìˆë‹¤. 

### ë”¥ëŸ¬ë‹ê´€ë ¨ ì†Œê°œ

- **ì „ë°˜ì ì¸ ë”¥ëŸ¬ë‹ ì½”ë“œ**
    
    ```python
    # 1ë‹¨ê³„. í”„ë ˆì„ë§Œ ì¶”ì¶œ/ì €ì¥
    import cv2, sys, os
    import imutils
    
    video_src = 0 # ë¹„ë””ì˜¤ íŒŒì¼ê³¼ ì¹´ë©”ë¼ ì„ íƒ ---â‘¡
    video_src = "./sample/22.mp4"
    cap = cv2.VideoCapture(video_src)
    
    fps = cap.get(cv2.CAP_PROP_FPS) # í”„ë ˆì„ ìˆ˜ êµ¬í•˜ê¸°
    delay = int(1000/fps)
    
    imgs = []
    # ìº¡ì²˜
    success = False
    count = 1
    
    while cap.isOpened():
        ret, frame = cap.read()
        if not ret :
            print("ì´ë¯¸ì§€ ì½ê¸° ì‹¤íŒ¨ ë˜ëŠ” ë‹¤ ì½ìŒ")
    
            # ë™ì˜ìƒ ìº¡ì²˜ ê°ì²´ë¥¼ ì¢…ë£Œ
            cap.release()
    
            # ì—´ë¦° ì°½ì„ ë‹«ì•„ì¤€ë‹¤
            cv2.destroyAllWindows()
            break
        frame = imutils.resize(frame, width=500, height = 500)
        if not ret:
            print('Cannot read video file')
            break
            
        img_draw = frame.copy()
         
        if success:
            cv2.imwrite("./vid/image{}.jpg".format(count), img_draw, params=[cv2.IMWRITE_PNG_COMPRESSION, 0])
            imgs.append(('./vid/image{}.jpg'.format(count)))
            print("./vid/image{}.jpg íŒŒì¼ì„ ì €ì¥".format(count))
            # í¬ê¸°ëŠ” frameí¬ê¸°ì™€ ê°™ê²Œ
            count +=1
        # ì¶”ì  ì‹¤íŒ¨
        if ret:
            success=True
        else:
            success=False
    ```
    
    ```python
    2ë‹¨ê³„. ìœ ì‚¬ë„ ë¹„êµ
    # ìœ ì‚¬ë„ ë¹„êµ(íˆìŠ¤í† ê·¸ë¨)
    # ìœ ì‚¬ë„ ìˆ˜ 30 ì´ìƒì´ë©´ ìœ ì‚¬ë„ ìˆ˜ì¹˜ ë‚®ì¶¤. 10 ë¯¸ë§Œì´ë©´ ë†’ì„
    hists = []
    # for j in range(len(imgs)):
    cut = 0
    cutimgnum = []
    for i in range(cut, len(imgs)) :
        #---â‘  ê° ì´ë¯¸ì§€ë¥¼ HSVë¡œ ë³€í™˜
        hsv = cv2.cvtColor(cv2.imread(imgs[i]), cv2.COLOR_BGR2HSV)
        #---â‘¡ H,S ì±„ë„ì— ëŒ€í•œ íˆìŠ¤í† ê·¸ë¨ ê³„ì‚°
        hist = cv2.calcHist([hsv], [0,1], None, [180,256], [0,180,0, 256])
        #---â‘¢ 0~1ë¡œ ì •ê·œí™”
        cv2.normalize(hist, hist, 0, 1, cv2.NORM_MINMAX)
        hists.append(hist)
    
        query = hists[cut]
        correl = cv2.HISTCMP_CORREL
        ret = cv2.compareHist(query, hist, correl)
    
        
        if ret > 0.80:
            print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
            image = "img%d:%7.2f"% (i+1 , ret)
        else:
            cut = i
            i = cut
            cutimgnum.append(i+1)
            print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
            print("ìœ ì‚¬ë„ ë”¸ë¦¼")
            
    if len(cutimgnum) < 10:
        print('******ìœ ì‚¬ë„ ë‹¤ì‹œ ë¹„êµ******')
        hists = []
        # for j in range(len(imgs)):
        cut = 0
        cutimgnum = []
        for i in range(cut, len(imgs)) :
            #---â‘  ê° ì´ë¯¸ì§€ë¥¼ HSVë¡œ ë³€í™˜
            hsv = cv2.cvtColor(cv2.imread(imgs[i]), cv2.COLOR_BGR2HSV)
            #---â‘¡ H,S ì±„ë„ì— ëŒ€í•œ íˆìŠ¤í† ê·¸ë¨ ê³„ì‚°
            hist = cv2.calcHist([hsv], [0,1], None, [180,256], [0,180,0, 256])
            #---â‘¢ 0~1ë¡œ ì •ê·œí™”
            cv2.normalize(hist, hist, 0, 1, cv2.NORM_MINMAX)
            hists.append(hist)
    
            query = hists[cut]
            correl = cv2.HISTCMP_CORREL
            ret = cv2.compareHist(query, hist, correl)
                    #                 ret = ret/query        #ë¹„êµëŒ€ìƒìœ¼ë¡œ ë‚˜ëˆ„ì–´ 1ë¡œ ì •ê·œí™”
    
            if ret > 0.90:
                print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
                image = "img%d:%7.2f"% (i+1 , ret)
            else:
                cut = i
                i = cut
                cutimgnum.append(i+1)
                print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
                print("ìœ ì‚¬ë„ ë”¸ë¦¼")
                
    if len(cutimgnum) > 30:
        print('******ìœ ì‚¬ë„ ë‹¤ì‹œ ë¹„êµ******')
        hists = []
        # for j in range(len(imgs)):
        cut = 0
        cutimgnum = []
        for i in range(cut, len(imgs)) :
            #---â‘  ê° ì´ë¯¸ì§€ë¥¼ HSVë¡œ ë³€í™˜
            hsv = cv2.cvtColor(cv2.imread(imgs[i]), cv2.COLOR_BGR2HSV)
            #---â‘¡ H,S ì±„ë„ì— ëŒ€í•œ íˆìŠ¤í† ê·¸ë¨ ê³„ì‚°
            hist = cv2.calcHist([hsv], [0,1], None, [180,256], [0,180,0, 256])
            #---â‘¢ 0~1ë¡œ ì •ê·œí™”
            cv2.normalize(hist, hist, 0, 1, cv2.NORM_MINMAX)
            hists.append(hist)
    
            query = hists[cut]
            correl = cv2.HISTCMP_CORREL
            ret = cv2.compareHist(query, hist, correl)
                    #                 ret = ret/query        #ë¹„êµëŒ€ìƒìœ¼ë¡œ ë‚˜ëˆ„ì–´ 1ë¡œ ì •ê·œí™”
    
            if ret > 0.60:
                print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
                image = "img%d:%7.2f"% (i+1 , ret)
            else:
                cut = i
                i = cut
                cutimgnum.append(i+1)
                print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
                print("ìœ ì‚¬ë„ ë”¸ë¦¼")
                
    if len(cutimgnum) > 30:
        print('******ìœ ì‚¬ë„ ë‹¤ì‹œ ë¹„êµ******')
        hists = []
        # for j in range(len(imgs)):
        cut = 0
        cutimgnum = []
        for i in range(cut, len(imgs)) :
            #---â‘  ê° ì´ë¯¸ì§€ë¥¼ HSVë¡œ ë³€í™˜
            hsv = cv2.cvtColor(cv2.imread(imgs[i]), cv2.COLOR_BGR2HSV)
            #---â‘¡ H,S ì±„ë„ì— ëŒ€í•œ íˆìŠ¤í† ê·¸ë¨ ê³„ì‚°
            hist = cv2.calcHist([hsv], [0,1], None, [180,256], [0,180,0, 256])
            #---â‘¢ 0~1ë¡œ ì •ê·œí™”
            cv2.normalize(hist, hist, 0, 1, cv2.NORM_MINMAX)
            hists.append(hist)
    
            query = hists[cut]
            correl = cv2.HISTCMP_CORREL
            ret = cv2.compareHist(query, hist, correl)
                    #                 ret = ret/query        #ë¹„êµëŒ€ìƒìœ¼ë¡œ ë‚˜ëˆ„ì–´ 1ë¡œ ì •ê·œí™”
    
            if ret > 0.50:
                print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
                image = "img%d:%7.2f"% (i+1 , ret)
            else:
                cut = i
                i = cut
                cutimgnum.append(i+1)
                print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
                print("ìœ ì‚¬ë„ ë”¸ë¦¼")
    if len(cutimgnum) > 30:
        print('******ìœ ì‚¬ë„ ë‹¤ì‹œ ë¹„êµ******')
        hists = []
        # for j in range(len(imgs)):
        cut = 0
        cutimgnum = []
        for i in range(cut, len(imgs)) :
            #---â‘  ê° ì´ë¯¸ì§€ë¥¼ HSVë¡œ ë³€í™˜
            hsv = cv2.cvtColor(cv2.imread(imgs[i]), cv2.COLOR_BGR2HSV)
            #---â‘¡ H,S ì±„ë„ì— ëŒ€í•œ íˆìŠ¤í† ê·¸ë¨ ê³„ì‚°
            hist = cv2.calcHist([hsv], [0,1], None, [180,256], [0,180,0, 256])
            #---â‘¢ 0~1ë¡œ ì •ê·œí™”
            cv2.normalize(hist, hist, 0, 1, cv2.NORM_MINMAX)
            hists.append(hist)
    
            query = hists[cut]
            correl = cv2.HISTCMP_CORREL
            ret = cv2.compareHist(query, hist, correl)
                    #                 ret = ret/query        #ë¹„êµëŒ€ìƒìœ¼ë¡œ ë‚˜ëˆ„ì–´ 1ë¡œ ì •ê·œí™”
    
            if ret > 0.40:
                print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
                image = "img%d:%7.2f"% (i+1 , ret)
            else:
                cut = i
                i = cut
                cutimgnum.append(i+1)
                print("ìœ ì‚¬ë„ ===> ", "img%d:%7.2f"% (i+1 , ret))
                print("ìœ ì‚¬ë„ ë”¸ë¦¼")
    ```
    
    ```python
    3ë‹¨ê³„. ëŒ€í‘œì´ë¯¸ì§€ì— roi ì²´í¬
    import cv2
    import numpy as np
    bbox1 = []
    point = ""
    isDragging = False                      # ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ ìƒíƒœ ì €ì¥ 
    x0, y0, w, h = -1,-1,-1,-1              # ì˜ì—­ ì„ íƒ ì¢Œí‘œ ì €ì¥
    blue, red = (255,0,0),(0,0,255)         # ìƒ‰ìƒ ê°’ 
    bbox2 = []
    win_name = 'Tracking APIs'
    def indent(elem, level=0):
        i = "\n" + level*"  "
        if len(elem):
            if not elem.text or not elem.text.strip():
                elem.text = i + "  "
                
            if not elem.tail or not elem.tail.strip():
                elem.tail = i
                
            for elem in elem:
                indent(elem, level+1)
                
            if not elem.tail or not elem.tail.strip():
                elem.tail = i
                
        else:
            if level and (not elem.tail or not elem.tail.strip()):
                elem.tail = i
    
    def onMouse(event,x,y,flags,param):     # ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ í•¸ë“¤ í•¨ìˆ˜  ---â‘ 
        global isDragging, x0, y0, img      # ì „ì—­ë³€ìˆ˜ ì°¸ì¡°
        if event == cv2.EVENT_LBUTTONDOWN:  # ì™¼ìª½ ë§ˆìš°ìŠ¤ ë²„íŠ¼ ë‹¤ìš´, ë“œë˜ê·¸ ì‹œì‘ ---â‘¡
            isDragging = True
            x0 = x
            y0 = y
        elif event == cv2.EVENT_MOUSEMOVE:  # ë§ˆìš°ìŠ¤ ì›€ì§ì„ ---â‘¢
            if isDragging:                  # ë“œë˜ê·¸ ì§„í–‰ ì¤‘
                img_draw = img.copy()       # ì‚¬ê°í˜• ê·¸ë¦¼ í‘œí˜„ì„ ìœ„í•œ ì´ë¯¸ì§€ ë³µì œ
                cv2.rectangle(img_draw, (x0, y0), (x, y), blue, 2) # ë“œë˜ê·¸ ì§„í–‰ ì˜ì—­ í‘œì‹œ
                cv2.imshow('img', img_draw) # ì‚¬ê°í˜• í‘œì‹œëœ ê·¸ë¦¼ í™”ë©´ ì¶œë ¥
        elif event == cv2.EVENT_LBUTTONUP:  # ì™¼ìª½ ë§ˆìš°ìŠ¤ ë²„íŠ¼ ì—… ---â‘£
            if isDragging:                  # ë“œë˜ê·¸ ì¤‘ì§€
                isDragging = False          
                w = x - x0                  # ë“œë˜ê·¸ ì˜ì—­ í­ ê³„ì‚°
                h = y - y0                  # ë“œë˜ê·¸ ì˜ì—­ ë†’ì´ ê³„ì‚°
                print("x:%d, y:%d, w:%d, h:%d" % (x0, y0, w, h))
                if w > 0 and h > 0:         # í­ê³¼ ë†’ì´ê°€ ì–‘ìˆ˜ì´ë©´ ë“œë˜ê·¸ ë°©í–¥ì´ ì˜³ìŒ ---â‘¤
                    img_draw = img.copy()   # ì„ íƒ ì˜ì—­ì— ì‚¬ê°í˜• ê·¸ë¦¼ì„ í‘œì‹œí•  ì´ë¯¸ì§€ ë³µì œ
                    # ì„ íƒ ì˜ì—­ì— ë¹¨ê°„ ì‚¬ê°í˜• í‘œì‹œ
                    cv2.rectangle(img_draw, (x0, y0), (x, y), red, 2) 
                    cv2.imshow('ROI', img_draw) # ë¹¨ê°„ ì‚¬ê°í˜• ê·¸ë ¤ì§„ ì´ë¯¸ì§€ í™”ë©´ ì¶œë ¥
                    roi = img[y0:y0+h, x0:x0+w] # ì›ë³¸ ì´ë¯¸ì§€ì—ì„œ ì„ íƒ ì˜ì˜ë§Œ ROIë¡œ ì§€ì • ---â‘¥
                    cv2.imshow('cropped', roi)  # ROI ì§€ì • ì˜ì—­ì„ ìƒˆì°½ìœ¼ë¡œ í‘œì‹œ
                    cv2.moveWindow('cropped', 0, 0) # ìƒˆì°½ì„ í™”ë©´ ì¢Œì¸¡ ìƒë‹¨ì— ì´ë™
                    cv2.imwrite('./cropped.jpg', roi)   # ROI ì˜ì—­ë§Œ íŒŒì¼ë¡œ ì €ì¥ ---â‘¦
                    print("croped.")
                    filename = ('image{}'.format(i))
                            # í¬ê¸°ëŠ” frameí¬ê¸°ì™€ ê°™ê²Œ
                    print("íŒŒì¼ì´ë¦„ > ", filename)
                    width = 500
                    height = 500
    
    for i in cutimgnum:
        
        img = cv2.imread('./vid/image{}.jpg'.format(i), cv2.IMREAD_COLOR)
        roi = cv2.selectROI(win_name, img, False)
        bbox2.append(roi)
        cv2.imshow('img', img)
        cv2.setMouseCallback('img', onMouse) # ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ë“±ë¡ ---â‘§
        cv2.waitKey()
        cv2.destroyAllWindows()
    ```
    
    ```python
    4ë‹¨ê³„. ì „ì²´ í”„ë ˆì„ì— ROI, ì´ë¯¸ì§€ì™€ XML íŒŒì¼ ì €ì¥
    import cv2, sys, os
    import imutils
    import numpy as np
    import matplotlib.pylab as plt
    # cv2 ë²„ì „ 3.4.15ë¡œ ë‚®ì¶°ì„œ í•  ê²ƒ
    # XMLíŒŒì¼ ìƒì„± from import
    from xml.etree.ElementTree import Element, SubElement, ElementTree, dump
    
    # goturn.caffemodel / goturn.prototxt ë‹¤ìš´ë°›ì•„ì„œ ì‹¤í–‰í•˜ëŠ” ipynbì™€ ê°™ì€ í´ë”ì— ë„£ê¸°
    # https://github.com/Mogball/goturn-files
    
    if not (os.path.isfile('goturn.caffemodel') and os.path.isfile('goturn.prototxt')):
        errorMsg = '''
        Could not find GOTURN model in current directory.
        Please ensure goturn.caffemodel and goturn.prototxt are in the current directory
        '''
    
        print(errorMsg)
        sys.exit()
    # íŠ¸ë™ì»¤ ê°ì²´ ìƒì„±ì í•¨ìˆ˜ ë¦¬ìŠ¤íŠ¸ ---â‘ 
    trackers = [cv2.TrackerBoosting_create, # 0
                cv2.TrackerMIL_create, # 1
                cv2.TrackerKCF_create, # 2
                cv2.TrackerTLD_create, # 3 
                cv2.TrackerMedianFlow_create, # 4
                cv2.TrackerGOTURN_create, # 5
                cv2.TrackerMOSSE_create, # 6
                cv2.TrackerCSRT_create] # 7
    trackerIdx = 7
        
    # íŠ¸ë™ì»¤ ìƒì„±ì í•¨ìˆ˜ ì„ íƒ ì¸ë±ìŠ¤
    tracker = None
    isFirst = True
    
    video_src = 0 # ë¹„ë””ì˜¤ íŒŒì¼ê³¼ ì¹´ë©”ë¼ ì„ íƒ ---â‘¡
    video_src = "./sample/92.mp4"
    cap = cv2.VideoCapture(video_src)
    
    fps = cap.get(cv2.CAP_PROP_FPS) # í”„ë ˆì„ ìˆ˜ êµ¬í•˜ê¸°
    delay = int(1000/fps)
    win_name = 'Tracking APIs'
    imgs = [] 
    
    # ìº¡ì²˜
    success = False
    count = 1
    co = 0
    # XML ì¤„ ì˜ˆì˜ê²Œ
    def indent(elem, level=0):
        i = "\n" + level*"  "
        if len(elem):
            if not elem.text or not elem.text.strip():
                elem.text = i + "  "
                
            if not elem.tail or not elem.tail.strip():
                elem.tail = i
                
            for elem in elem:
                indent(elem, level+1)
                
            if not elem.tail or not elem.tail.strip():
                elem.tail = i
                
        else:
            if level and (not elem.tail or not elem.tail.strip()):
                elem.tail = i
    
        
    while cap.isOpened():
         
        ret, frame = cap.read()
        if not ret :
            print("ì´ë¯¸ì§€ ì½ê¸° ì‹¤íŒ¨ ë˜ëŠ” ë‹¤ ì½ìŒ")
    
            # ë™ì˜ìƒ ìº¡ì²˜ ê°ì²´ë¥¼ ì¢…ë£Œ
            cap.release()
    
            # ì—´ë¦° ì°½ì„ ë‹«ì•„ì¤€ë‹¤
            cv2.destroyAllWindows()
            break
        frame = imutils.resize(frame, width=500)
        if not ret:
            print('Cannot read video file')
            break
            
        img_draw = frame.copy()
        
        # íŠ¸ë™ì»¤ ìƒì„± ì•ˆëœ ê²½ìš° "Press the Space to set ROI!!"ê¸€ì ë„ì›€
        if tracker is None: 
            cv2.putText(img_draw, "Press the Space to set ROI!!", \
                (100,80), cv2.FONT_HERSHEY_SIMPLEX, 0.75,(0,0,255),2,cv2.LINE_AA)
        
        # íŠ¸ë™ì»¤ ìƒì„±ëœ ê²½ìš°
        else:
            ok, bbox = tracker.update(frame)   # ìƒˆë¡œìš´ í”„ë ˆì„ì—ì„œ ì¶”ì  ìœ„ì¹˜ ì°¾ê¸° ---â‘¢
            (x,y,w,h) = bbox
            
            # ì¶”ì  ì„±ê³µ
            if ok: 
                cv2.rectangle(img_draw, (int(x), int(y)), (int(x + w), int(y + h)), \
                              (0,255,0), 2, 1)
                print("í¬ì¸í„° ìœ„ì¹˜{}:".format(count),int(x), int(y), int(x + w), int(y + h))
                #print("bboxì˜ xìœ„ì¹˜:",bbox[0])
                
                # ì¶”ì  ì„±ê³µí•˜ë©´ ìº¡ì²˜í•´ì„œ ì €ì¥
                if success:
                    cv2.imwrite("./vi/image{}.jpg".format(count), img_draw, params=[cv2.IMWRITE_PNG_COMPRESSION, 0])
                    imgs.append(cv2.imread('./vi/image{}.jpg'.format(count)))
                    print("./vi/image{}.jpg íŒŒì¼ì„ ì €ì¥".format(count))
                    if cv2.waitKey(10) == 27:
                        break
          
                    
                    # bbox ì¢Œí‘œê°’ì„ ê°€ì§„ XMLíŒŒì¼ ìƒì„± 
                    filename = 'image{}'.format(count)
    
                    # í¬ê¸°ëŠ” frameí¬ê¸°ì™€ ê°™ê²Œ
                    width = 500
                    height = 500
    
                    # bbox ì¢Œí‘œ
                    point1 = (int(x), int(y))
                    point2 = (int(x+w), int(y+h))
                    
                    # ê°ì²´ì´ë¦„
                    label = 'crown'
    
                    root = Element('annotation')
                    SubElement(root, 'folder').text = 'annotation'
                    SubElement(root, 'filename').text = filename + '.jpg'
                    SubElement(root, 'path').text = './annotation/' +  filename + '.jpg'
                    source = SubElement(root, 'source')
                    SubElement(source, 'database').text = 'Unknown'
    
                    size = SubElement(root, 'size')
                    SubElement(size, 'width').text = str(width)
                    SubElement(size, 'height').text = str(height)
                    SubElement(size, 'depth').text = '1'
    
                    SubElement(root, 'segmented').text = '0'
    
                    obj = SubElement(root, 'object')
                    SubElement(obj, 'name').text = label
                    SubElement(obj, 'pose').text = 'Unspecified'
                    SubElement(obj, 'truncated').text = '0'
                    SubElement(obj, 'difficult').text = '0'
                    bbox = SubElement(obj, 'bndbox')
                    SubElement(bbox, 'xmin').text = str(point1[0])
                    SubElement(bbox, 'ymin').text = str(point1[1])
                    SubElement(bbox, 'xmax').text = str(point2[0])
                    SubElement(bbox, 'ymax').text = str(point2[1])
                    
    
                    indent(root)
                    
                    tree = ElementTree(root)
                    tree.write('./annotation/' + filename +'.xml')
                    print("./annotation/image{}.xml íŒŒì¼ì„ ì €ì¥".format(count))
                                  
                    count +=1
    #             if count == cutimgnum:
    #                     roi1=(bbox1[0][0],bbox1[0][1],bbox1[0][2],bbox1[0][3])
    
                    print(cap.get(cv2.CAP_PROP_POS_FRAMES))
                    if cutimgnum[co]==int(cap.get(cv2.CAP_PROP_POS_FRAMES)):
                        roi=bbox2[co]
                        co+=1                    
                        if roi[2] and roi[3]:          
                            tracker = trackers[trackerIdx]()    #íŠ¸ë™ì»¤ ê°ì²´(ë°•ìŠ¤) ìƒì„± ---â‘¤
                            isInit = tracker.init(frame, roi)
        
            # ì¶”ì  ì‹¤íŒ¨
            else : 
                cv2.putText(img_draw, "Tracking fail.", (100,80), \
                            cv2.FONT_HERSHEY_SIMPLEX, 0.75,(0,0,255),2,cv2.LINE_AA)
                
            
        trackerName = tracker.__class__.__name__
        cv2.putText(img_draw, str(trackerIdx) + ":"+trackerName , (100,20), \
                     cv2.FONT_HERSHEY_SIMPLEX, 0.75, (0,255,0),2,cv2.LINE_AA)
        
        
        
        cv2.imshow(win_name, img_draw)
        key = cv2.waitKey(delay) & 0xff
        
        if ret:
            success=True
        else:
            success=False
        
        if(video_src != 0 and isFirst): 
            
            # ì²˜ìŒë¶€í„° ì‹œì‘ í•˜ì§€ë§ˆ
            isFirst = False 
            
            roi = cv2.selectROI(win_name, frame, False)  # ì´ˆê¸° ê°ì²´ ìœ„ì¹˜ ì„¤ì • 
            print("ì´ˆê¸° roiê°’:",roi)
    
            #ìœ„ì¹˜ ì„¤ì • ê°’ ìˆëŠ” ê²½ìš°
            if roi[2] and roi[3]:         
                tracker = trackers[trackerIdx]()    #íŠ¸ë™ì»¤ ê°ì²´(ë°•ìŠ¤) ìƒì„± ---â‘¤
                print("íŠ¸ë™ì»¤:",tracker)
                isInit = tracker.init(frame, roi)
                    
            if cutimgnum[co]==count:
                roi=bbox2[co]
                co+=1                    
                if roi[2] and roi[3]:          
                    tracker = trackers[trackerIdx]()    #íŠ¸ë™ì»¤ ê°ì²´(ë°•ìŠ¤) ìƒì„± ---â‘¤
                    print("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@")
                    isInit = tracker.init(frame, roi)
                            
        elif key in range(48, 56): # 0~7 ìˆ«ì ì…ë ¥   ---â‘¥
            trackerIdx = key-48     # ì„ íƒí•œ ìˆ«ìë¡œ íŠ¸ë™ì»¤ ì¸ë±ìŠ¤ ìˆ˜ì •
            
            if bbox is not None:
                tracker = trackers[trackerIdx]() # ì„ íƒí•œ ìˆ«ìì˜ íŠ¸ë™ì»¤ ê°ì²´ ìƒì„± ---â‘¦
                isInit = tracker.init(frame, bbox) # ì´ì „ ì¶”ì  ìœ„ì¹˜ë¡œ ì¶”ì  ìœ„ì¹˜ ì´ˆê¸°í™”
                
        elif key == 27 : 
            break
    else:
        print( "Could not open video")
    cap.release()
    cv2.destroyAllWindows()
    ```
    

### 1) ì´ˆê¸°ì˜ tracker api ì‚¬ìš©

ì´ˆê¸°ì—ëŠ” ë¬¼ì²´ë¥¼ íƒì§€í•˜ëŠ” tracker apië¥¼ ì¨ì„œ ë¬¼ì²´íƒì§€í•˜ëŠ” ê¸°ëŠ¥ì„ ì •í™•ë„ ë†’ì€ ëª¨ë¸ë¡œ ë¬¼ì²´ë¥¼ ì¶”ì í•˜ê²Œ í•˜ì˜€ë‹¤. ê·¸ëŸ¬ë‚˜ ì—¬ëŸ¬ ë™ì˜ìƒì˜ ë¬¼ì²´ë¥¼ ì¶”ì í•˜ê²Œ í–ˆì„ ê²½ìš°, ë¬¼ì²´ë¥¼ ì˜ ì¶”ì í•˜ì§€ ëª»í–ˆë‹¤. ê·¸ ì´ìœ ëŠ” ë°°ê²½ê³¼ ë¬¼ì²´ì˜ ìƒ‰ì´ ë¹„ìŠ·í•  ê²½ìš° ê°™ì€ ë¬¼ì²´ë¼ê³  ì¸ì‹í•˜ì˜€ê¸° ë•Œë¬¸ì´ë‹¤. 

### 2) ëª¨ë¸ ë³€ê²½

ì´ í›„ì— ì •í™•ë„ê°€ ë†’ì§€ ì•Šì€ ê²ƒì„ í™•ì¸í•˜ì—¬ ì—¬ëŸ¬ ëª¨ë¸ì„ ì¼ë‹¤. ë‚˜ì¤‘ì— yoloëª¨ë¸ì„ ì¨ì„œ ì •í™•ë„ë¥¼ ë†’ì˜€ë‹¤. ê·¸ë¦¬ê³  íšŒì‚¬ì˜ í”¼ë“œë°±ì„ ë°›ì•„ ìœ ì‚¬ë„ë¥¼ ë¹„êµí•˜ì˜€ë‹¤. ê·¸ë¦¬ê³  íˆìŠ¤í† ê·¸ë¨ì„ ì‚¬ìš©í•˜ì—¬ ë™ì˜ìƒì—ì„œ bboxë¥¼ ì³¤ì„ ë•Œ ë¬¼ì²´ë¥¼ ì˜ ë”°ë¼ê°ˆ ìˆ˜ ìˆê²Œ í•˜ì˜€ë‹¤. 

ê·¸ë¦¬ê³  ì •í™•ë„ê°€ ì–´ëŠ ì •ë„ ë˜ëŠ”ì§€ ì•Œê³  ì‹¶ì–´ì„œ ***í”„ë ˆì„ì„ ë½‘ì•„ì„œ ì €ì¥***í•œ í›„ì— ì´ë¥¼ í•™ìŠµì‹œì¼œ ì •í™•ë„ì™€ ì •ë°€ë„ë¥¼ ë½‘ì•„ì„œ ì–´ëŠ ì •ë„ì˜ ì •í™•ë„ê°€ ë†’ë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆë‹¤. 

ê·¸ë¦¬ê³  ë™ì˜ìƒì— bboxê°€ ë¬¼ì²´ë¥¼ ì˜ ë”°ë¼ê°ˆ ìˆ˜ ìˆë„ë¡ ***ëŒ€í‘œì´ë¯¸ì§€ë¥¼ ì—¬ëŸ¬ ê°œ ë½‘ì•„ë‚´ì–´ ê´€ì‹¬ ì˜ì—­ì„ ì§€ì •***í•˜ì˜€ë‹¤. ê·¸ë¦¬ê³  í•™ìŠµí•œ ê²°ê³¼ë¬¼ì„ ì‚¬ìš©ìë“¤ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ***ì§€ì •í•œ ì¢Œí‘œê°’ì„ xmlíŒŒì¼ë¡œ ì €ì¥***í•˜ì˜€ë‹¤. ì´ëŠ” ì‚¬ìš©ìë“¤ì´ ë‹¤ìš´ë°›ì•„ì„œ XMLíŒŒì¼ì„ ì´ìš©í•´ í•™ìŠµì‹œí‚¬ ìˆ˜ ìˆë‹¤.
